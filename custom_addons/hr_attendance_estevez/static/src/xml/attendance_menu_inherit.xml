<?xml version="1.0" encoding="UTF-8"?>
<templates>
    <t t-inherit="hr_attendance.attendance_menu" t-inherit-mode="extension" priority="20">
        <xpath expr="//div[contains(@class, 'o_att_menu_container')]/div[contains(@class, 'd-flex') and contains(@class, 'flex-column') and contains(@class, 'gap-3')]" position="replace">
            <div>
                <div style="background: #fff; border-radius: 12px; box-shadow: 0 2px 8px #0001; padding: 18px 20px; margin-bottom: 18px; text-align: left; max-width: 350px; margin-left: auto; margin-right: auto;">
                    <div style="font-size: 1.3em; font-weight: 700; color: #222; margin-bottom: 10px;">Asistencia Diaria</div>
                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                        <span style="color: #2ecc40; font-size: 1.2em; margin-right: 8px;">
                            <i class="fa fa-check-circle"></i>
                        </span>
                        <span style="font-weight: 600; color: #222;">Estado de la jornada:</span>
                    </div>
                    <div style="margin-bottom: 10px; color: #444;">
                        Actualmente tiene una jornada activa.<br/>
                        No olvide marcar su salida al finalizar sus actividades.
                    </div>
                    <div style="font-weight: 600; color: #222; margin-bottom: 4px;">Ubicación detectada:</div>
                    <div style="margin-bottom: 2px; color: #444;">
                        Lat: <t t-esc="state.latitude"/> Long: <t t-esc="state.longitude"/>
                    </div>
                    <div style="margin-bottom: 8px; color: #444;">
                        IP Pública: <t t-esc="state.ipaddress"/>
                    </div>
                    <t t-if="state.geofence_name">
                        <div style="font-weight: 600; color: #007bff; margin-bottom: 2px;">
                            <t t-esc="state.geofence_name"/>
                        </div>
                        <t t-if="state.geofence_description">
                            <div style="color: #555; font-size: 0.95em; margin-bottom: 8px;">
                                <t t-esc="state.geofence_description"/>
                            </div>
                        </t>
                    </t>
                </div>
                <!-- Botón original duplicado para mantener funcionalidad -->
                <button t-if="this.isFirstAttendance" t-on-click="() => this.signInOut()" t-attf-class="btn btn-{{ this.state.checkedIn ? 'warning' : 'success' }}">
                    <span t-if="!this.state.checkedIn">Check in</span>
                    <span t-else="">Check out</span>
                    <i t-attf-class="fa fa-sign-{{ this.state.checkedIn ? 'out' : 'in' }} ms-1"/>
                </button>
            </div>
        </xpath>
    </t>
</templates>